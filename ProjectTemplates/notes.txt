This should be spun off into an R&S internal library